#!/usr/bin/env ruby

require 'daemons'

begin
  user = Etc.getpwnam(RUN_AS_USER)
  Process::UID.change_privilege(user.uid)
  Process::GID.change_privilege(user.gid)
rescue => e
  puts "Should be run as webapp user"
  puts "Error: #{e.message}"
  exit 1
end

require 'daemons'

Daemons.run('start_foreman.rb')